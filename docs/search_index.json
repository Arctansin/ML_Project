[["index.html", "Machine Learning Project Chapter 1 Explonatory Analysis 1.1 Target Sampling 1.2 Split Variables 1.3 Missing Value 1.4 Separation Issue 1.5 Test data and the Final Data", " Machine Learning Project Mingming Li 2022-01-12 Chapter 1 Explonatory Analysis Training Data : train Testing Data : test 1.1 Target Sampling unique(train$INS) ## [1] 0 1 sum(train$INS==1)/length(train$INS) ## [1] 0.3434962 1.2 Split Variables Categorical variable level&lt;10 type=character col_unique&lt;-lapply(lapply(train,unique),length) catag_variable&lt;-names(col_unique[col_unique&lt;=10]) chara_type&lt;-lapply(train,typeof) chara_names&lt;-names(chara_type[chara_type==&quot;character&quot;]) catag_variable&lt;-unique(c(chara_names,catag_variable)) Continuous variable conti_variable&lt;-names(train) conti_variable&lt;-subset(conti_variable,!(conti_variable%in%catag_variable)) 1.3 Missing Value Finding the variable that has missing value Imputing the missing value in categorical variable as “Missing” Imputing the missing value in continuous variable as median, and adding related Flag #finding variables that have missing value na_check=colSums(is.na(train)) na_variable=na_check[na_check&gt;0] na_variable/nrow(train) ## ACCTAGE PHONE POS POSAMT INV INVBAL ## 0.06427310 0.12654503 0.12654503 0.12654503 0.12654503 0.12654503 ## CC CCBAL CCPURC INCOME LORES HMVAL ## 0.12654503 0.12654503 0.12654503 0.18092996 0.18092996 0.18092996 ## AGE CRSCORE ## 0.20035315 0.02295468 na_cata&lt;-names(na_variable)[names(na_variable) %in% catag_variable] na_conti&lt;-names(na_variable)[names(na_variable) %in% conti_variable] flag_matrix=matrix(rep(0,nrow(train)*length(na_conti)),nrow=nrow(train),ncol = length(na_conti)) colnames(flag_matrix)=c(paste(na_conti,&quot;_flag&quot;,sep=&quot;&quot;)) #impute the continuous variable for (i in seq(1:length(na_conti))){ mid_point=median(train[,na_conti[i]],na.rm = TRUE) flag_matrix[is.na(train[,na_conti[i]]),i]=1 train[,na_conti[i]]=replace_na(train[,na_conti[i]],mid_point) } #impute the categorical variable for (i in seq(1:length(na_cata))){ train[,na_cata[i]]=replace_na(train[,na_cata[i]],&quot;missing&quot;) } 1.4 Separation Issue Relationship between any catagorical variable and the target variable for (i in seq(1,length(catag_variable))){ print(catag_variable[i]) print(table(train$INS,train[,catag_variable[i]])) } ## [1] &quot;BRANCH&quot; ## ## B1 B10 B11 B12 B13 B14 B15 B16 B17 B18 B19 B2 B3 B4 B5 B6 B7 B8 ## 0 472 49 33 89 82 220 427 286 128 103 54 961 458 924 476 246 259 217 ## 1 259 33 26 51 62 51 141 94 83 55 24 454 269 557 267 146 134 150 ## ## B9 ## 0 93 ## 1 62 ## [1] &quot;DDA&quot; ## ## 0 1 ## 0 746 4831 ## 1 851 2067 ## [1] &quot;DIRDEP&quot; ## ## 0 1 ## 0 3793 1784 ## 1 2186 732 ## [1] &quot;NSF&quot; ## ## 0 1 ## 0 5015 562 ## 1 2747 171 ## [1] &quot;SAV&quot; ## ## 0 1 ## 0 3264 2313 ## 1 1270 1648 ## [1] &quot;ATM&quot; ## ## 0 1 ## 0 1956 3621 ## 1 1391 1527 ## [1] &quot;CD&quot; ## ## 0 1 ## 0 5170 407 ## 1 2298 620 ## [1] &quot;IRA&quot; ## ## 0 1 ## 0 5384 193 ## 1 2619 299 ## [1] &quot;INV&quot; ## ## 0 1 missing ## 0 4689 84 804 ## 1 2492 155 271 ## [1] &quot;MM&quot; ## ## 0 1 ## 0 5134 443 ## 1 2342 576 ## [1] &quot;MMCRED&quot; ## ## 0 1 2 3 5 ## 0 5409 130 33 4 1 ## 1 2713 153 47 5 0 ## [1] &quot;CC&quot; ## ## 0 1 missing ## 0 2729 2044 804 ## 1 1134 1513 271 ## [1] &quot;CCPURC&quot; ## ## 0 1 2 3 4 missing ## 0 4279 404 68 18 4 804 ## 1 2216 352 68 10 1 271 ## [1] &quot;SDB&quot; ## ## 0 1 ## 0 5053 524 ## 1 2514 404 ## [1] &quot;INAREA&quot; ## ## 0 1 ## 0 173 5404 ## 1 154 2764 ## [1] &quot;INS&quot; ## ## 0 1 ## 0 5577 0 ## 1 0 2918 Imputing the quasic-complete separation, and adding a corresponding flag train$MMCRED_sep_flag=0 train$MMCRED_sep_flag[train$MMCRED&gt;2]=1 train$MMCRED[train$MMCRED&gt;2]=&quot;3+&quot; new_train=cbind(train,flag_matrix) factorize the categorical variable for(i in c(catag_variable,&quot;MMCRED_sep_flag&quot;,colnames(flag_matrix))){ new_train[,i]=as.factor(new_train[,i]) } 1.5 Test data and the Final Data Do the same data posturing on the test data ### NA replace with &quot;missing&quot; or median value ## na_variable store all the vaiables with missing value na_check_train=colSums(is.na(train)) na_variable_train=na_check[na_check_train&gt;0] na_check=colSums(is.na(test)) na_variable=na_check[na_check&gt;0] na_variable %in% na_variable_train ## [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [13] FALSE FALSE na_variable/nrow(test) ## ACCTAGE PHONE POS POSAMT INV INVBAL ## 0.06214689 0.12146893 0.12146893 0.12146893 0.12146893 0.12146893 ## CC CCBAL CCPURC INCOME LORES HMVAL ## 0.12146893 0.12146893 0.12146893 0.18785311 0.18785311 0.18785311 ## AGE CRSCORE ## 0.20668550 0.02401130 na_cata&lt;-names(na_variable)[names(na_variable) %in% catag_variable] na_conti&lt;-names(na_variable)[names(na_variable) %in% conti_variable] flag_matrix=matrix(rep(0,nrow(test)*length(na_conti)),nrow=nrow(test),ncol = length(na_conti)) colnames(flag_matrix)=c(paste(na_conti,&quot;_flag&quot;,sep=&quot;&quot;)) #impute the continuous variable for (i in seq(1:length(na_conti))){ mid_point=median(test[,na_conti[i]],na.rm = TRUE) flag_matrix[is.na(test[,na_conti[i]]),i]=1 test[,na_conti[i]]=replace_na(test[,na_conti[i]],mid_point) } #impute the categorical variable for (i in seq(1:length(na_cata))){ test[,na_cata[i]]=replace_na(test[,na_cata[i]],&quot;missing&quot;) } test$MMCRED_sep_flag=0 test$MMCRED_sep_flag[test$MMCRED&gt;2]=1 test$MMCRED[test$MMCRED&gt;2]=&quot;3+&quot; new_test=cbind(test,flag_matrix) #factorize the categorical variable for(i in c(catag_variable,&quot;MMCRED_sep_flag&quot;,colnames(flag_matrix))){ new_test[,i]=as.factor(new_test[,i]) } Split the training into two pieces, train and val set.seed(123) index=sample(1:nrow(new_train),0.7*nrow(new_train)) train=new_train[index,] val=new_train[-(index),] test=new_test "],["model-building.html", "Chapter 2 Model Building 2.1 Earth algorithm", " Chapter 2 Model Building 2.1 Earth algorithm mars2 &lt;- earth(INS ~ ., data = train,glm = list(family = binomial)) summary(mars2) ## Call: earth(formula=INS~., data=train, glm=list(family=binomial)) ## ## GLM coefficients ## 1 ## (Intercept) 12.4962153 ## DDA1 -1.1873152 ## IRA1 0.6075324 ## INV1 0.4968479 ## INVmissing -0.5275512 ## CC1 0.4248063 ## BRANCHB16 -0.5909910 ## h(5.6-ACCTAGE) 0.0786095 ## h(DDABAL-1304.97) -0.0005778 ## h(9011.31-DDABAL) -0.0006905 ## h(DDABAL-9011.31) 0.0005864 ## h(4-DEP) 0.1206177 ## h(CHECKS-1) -0.0402306 ## h(2-TELLER) -0.1595330 ## h(TELLER-2) 0.0728178 ## h(SAVBAL-1520.04) -0.0003573 ## h(6272.8-SAVBAL) -0.0005466 ## h(SAVBAL-6272.8) 0.0003550 ## h(12661.3-ATMAMT) -0.0000965 ## h(21300-CDBAL) -0.0000800 ## h(31366-MMBAL) -0.0000496 ## h(MMBAL-31366) -0.0000977 ## h(2654.41-CCBAL) 0.0001692 ## ## GLM (family binomial, link logit): ## nulldev df dev df devratio AIC iters converged ## 7680.57 5945 6177.36 5923 0.196 6223 4 1 ## ## Earth selected 23 of 29 terms, and 16 of 74 predictors ## Termination condition: RSq changed by less than 0.001 at 29 terms ## Importance: SAVBAL, MMBAL, CDBAL, DDA1, DDABAL, CC1, IRA1, CCBAL, ... ## Number of terms at each degree of interaction: 1 22 (additive model) ## Earth GCV 0.1755326 RSS 1027.979 GRSq 0.2260737 RSq 0.2374873 evimp(mars2) ## nsubsets gcv rss ## SAVBAL 22 100.0 100.0 ## MMBAL 20 68.4 69.9 ## CDBAL 20 63.8 65.6 ## DDA1 19 53.2 55.7 ## DDABAL 19 53.2 55.7 ## CC1 15 33.3 37.1 ## IRA1 15 29.8 34.2 ## CCBAL 14 30.6&gt; 34.5&gt; ## CHECKS 14 27.5 31.9 ## ATMAMT 13 25.9 30.3 ## TELLER 12 24.3 28.6 ## INVmissing 11 21.8 26.3 ## ACCTAGE 9 19.2 23.4 ## BRANCHB16 7 14.1 18.4 ## DEP 3 9.3 12.1 ## INV1 1 5.3 7.0 library(InformationValue) #ROC curve #validation ROC mars_val&lt;-predict(mars2,newdata=val,type=&quot;response&quot;) plotROC(val$INS,mars_val) "],["model-evaluation.html", "Chapter 3 Model Evaluation", " Chapter 3 Model Evaluation "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
